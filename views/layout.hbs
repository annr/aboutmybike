<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{{app_name}} - {{page_title}}</title>
    <link rel="stylesheet" media="all" href="/css/main.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- ah! get this shit out of the head -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7" crossorigin="anonymous"></script>
    <script src="/javascripts/util.js"></script>
    <script src="/javascripts/modal.js"></script>
    <script src="/javascripts/tab.js"></script>
    <script src="/javascripts/awesomplete.js"></script>


    <!-- I don't think this is the best way to do this, but we'll just always update the login form's target when
      the user clicks on a link that could require login -->
    <script>
    $(document).ready(function() {
      $('.auth-req-link').click(function() {
         $('#loginForm input[name=target]').val($(this).attr('href'));
      });
    });
    </script>
  </head>

  <body>

  <div class="container">

      <div class="header clearfix">
        <nav>
          <ul class="nav nav-pills float-right nav-link-hack">
            <li class="nav-item">
              <a class="nav-link" href="/bikes">Bikes</a>
            </li>
            <!-- remove this link when the user has created a bike -->
            <li class="nav-item">
              <a class="nav-link auth-req-link" href="/add" {{#unless user}}data-toggle="modal" data-target="#loginModal"{{/unless}}>+ Add Your Bike</a>
            </li>

            {{#if user}}
              <div class="dropdown show">
                <a class="btn btn-secondary dropdown-toggle" href="https://example.com" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Dropdown link
                </a>

                <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                  <a class="dropdown-item" href="/profile">Profile</a>
                  <a class="dropdown-item" href="/logout">Log out</a>
                </div>
              </div>
            {{else}}
            <li class="nav-item">
              <a class="nav-link auth-req-link" data-toggle="modal" data-target="#loginModal" href="/">Log in</a>
            </li>
            {{/if}}

          </ul>
        </nav>
        <h4 class="text-muted amb-text-logo"><a href="/">{{app_name}}</a></h4>
      </div>

    {{{body}}}

<br>
     <footer><a href="/feedback">Feedback / Questions</a><p><small>Â©2017 AboutMyBike.com</p></small></p></footer>


  </div>

  <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">{{app_name}} Login</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">

        <form action="/login" method="post" id="loginForm">
          <input name="username" id="username" type="text" placeholder="Your username" />
          <input name="password" id="password" type="password" placeholder="Your password"/>
          <input type="hidden" id="target" name="target" value="/" />
          <input type="submit" />
        </form>

       </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>


  <!-- PLACEHOLDER to preload js for other pages. this hs is not used or required for main pages (home, bikes, bike and add) -->


    <!-- /container -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="/javascripts/ie10-viewport-bug-workaround.js"></script>
  </body>
</html>

